package com.example.cve.controller;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class Log4jTestController {
	
//	TODO 測試使用
	private static final Logger LOGGER = LogManager.getLogger(Log4jTestController.class);
	
//	測試情況，編碼前 ${jndi:ldap://127.0.0.1:3089/}
//	url編碼工具https://meyerweb.com/eric/tools/dencoder/
//	url編碼後，%24%7Bjndi%3Aldap%3A%2F%2F127.0.0.1%3A3089%2F%7D
	@GetMapping("/vuln")
	public String testLog(@RequestParam("userInput")String userInput) {
		LOGGER.info("[+] [testLog] userInput: " + userInput);
		return "{}";
	}
	
//	測試防止，扣除升級。加上參數VM argmuments -Dlog4j2.formatMsgNoLookups=true
	
}
